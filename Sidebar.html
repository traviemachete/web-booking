<!-- Sidebar.html -->
<div class="layout">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="user-info" id="userInfo">
      <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ -->
      <p class="not-logged"><strong>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</strong></p>
    </div>

    <ul class="menu">
      <li><a href="#" onclick="loadView('calendar')">üìÖ ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a></li>
      <li><a href="#" onclick="ensureAuth(() => loadView('form'))">üìù ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°</a></li>
    </ul>
  </aside>

  <!-- Main Content -->
  <main class="main-content" id="mainContent">
    <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
  </main>
</div>

<style>
  :root {
    --bg-color: #202124;
    --text-color: #e8eaed;
    --primary-color: #8ab4f8;
    --hover-color: #3c4043;
    --sidebar-bg: #202124;
    --sidebar-hover: #3c4043;
    --btn-login-bg: #8ab4f8;
    --btn-login-text: #202124;
    --radius: 8px;
  }

  .layout {
    display: flex;
    min-height: 100vh;
    font-family: 'Kanit', sans-serif;
  }

  .sidebar {
    width: 250px;
    background-color: var(--sidebar-bg);
    color: var(--text-color);
    padding: 1rem;
    border-right: 1px solid #3c4043;
  }

  .user-info {
    margin-bottom: 2rem;
    text-align: center;
  }

  .user-info p {
    margin-bottom: 10px;
    color: var(--text-color);
  }

  .btn-login {
    padding: 6px 16px;
    background-color: var(--btn-login-bg);
    color: var(--btn-login-text);
    border: none;
    border-radius: var(--radius);
    font-size: 14px;
    cursor: pointer;
    transition: background-color 0.3s;
  }

  .btn-login:hover {
    background-color: #a4c6fa;
  }

  .menu {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .menu li {
    margin-bottom: 10px;
  }

  .menu a {
    color: var(--text-color);
    text-decoration: none;
    display: flex;
    align-items: center;
    padding: 10px 14px;
    border-radius: var(--radius);
    transition: background-color 0.2s;
    font-weight: 500;
  }

  .menu a:hover {
    background-color: var(--hover-color);
  }

  .main-content {
    flex-grow: 1;
    padding: 20px;
    background-color: var(--bg-color);
  }

  @media screen and (max-width: 768px) {
    .layout {
      flex-direction: column;
    }

    .sidebar {
      width: 100%;
      height: auto;
      display: flex;
      flex-direction: row;
      justify-content: space-around;
      align-items: center;
      padding: 10px 20px;
    }

    .menu {
      display: flex;
      gap: 10px;
    }

    .main-content {
      padding-top: 100px;
    }
  }
</style>

<script>
  // ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
  function renderUserBox() {
    google.script.run.withSuccessHandler(user => {
      const el = document.getElementById("userInfo");

      if (user) {
        el.innerHTML = `
          <p>üë§ <strong>${user.name}</strong></p>
          <button class="btn-login" onclick="logout()">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
        `;
      } else {
        el.innerHTML = `
          <p class="not-logged"><strong>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</strong></p>
          <button class="btn-login" onclick="loadView('login')">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
        `;
      }
    }).getSessionUser();
  }

  function logout() {
    google.script.run.withSuccessHandler(() => {
      renderUserBox();
      loadView('calendar');
    }).logoutUser();
  }

  function ensureAuth(callback){
    google.script.run.withSuccessHandler(user => {
      if (user) {
        callback();
      } else {
        M.toast({html: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ä‡∏∏‡∏°"});
        loadView('login');
      }
    }).getSessionUser();
  }

  window.addEventListener("DOMContentLoaded", renderUserBox);
</script>
