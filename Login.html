<!-- Login.html -->
<div class="auth-box">
  <h3>เข้าสู่ระบบ</h3>
  <form id="loginForm">
    <input name="email" type="email" placeholder="Email" required />
    <input name="pwd" type="password" placeholder="Password" required />
    <button class="btn blue" type="submit">เข้าสู่ระบบ</button>
    <p class="small">ยังไม่มีบัญชี? <a href="#" onclick="loadView('register')">ลงทะเบียน</a></p>
  </form>
</div>

<script>
document.getElementById("loginForm").addEventListener("submit", e => {
  e.preventDefault();
  const data = {
    email: e.target.email.value.trim(),
    pwd:   e.target.pwd.value.trim()
  };
  google.script.run
    .withSuccessHandler(function(){ parent.M.toast({html:'✅ เข้าสู่ระบบ'}); parent.loadView('calendar'); parent.renderSidebarLinks && parent.renderSidebarLinks(); }) => {
      M.toast({html: '✅ เข้าสู่ระบบสำเร็จ'});
      renderUserBox();
      loadView('calendar');
    })
    .withFailureHandler(err => M.toast({html: err.message}))
    .loginUser(data);
});
</script>
